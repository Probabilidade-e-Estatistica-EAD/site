<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>ch7_reg_simples.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.21.4 and GitBook 2.6.7" />

  <meta property="og:title" content="ch7_reg_simples.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="ch7_reg_simples.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/header-attrs-2.7.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />










<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path=""><a href="#prefácio"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="1" data-path=""><a href="#linRegrForTwoVar"><i class="fa fa-check"></i><b>1</b> Introdução à Regressão Linear</a>
<ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#lineFittingResidualsCorrelation"><i class="fa fa-check"></i><b>1.1</b> Ajuste linear, resíduos e correlação</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path=""><a href="#começando-com-linhas-retas"><i class="fa fa-check"></i><b>1.1.1</b> Começando com linhas retas</a></li>
<li class="chapter" data-level="1.1.2" data-path=""><a href="#sobrepor-uma-linha-visualmente"><i class="fa fa-check"></i><b>1.1.2</b> Sobrepor uma linha visualmente</a></li>
<li class="chapter" data-level="1.1.3" data-path=""><a href="#resíduos"><i class="fa fa-check"></i><b>1.1.3</b> Resíduos</a></li>
<li class="chapter" data-level="1.1.4" data-path=""><a href="#descrevendo-relacionamentos-lineares-com-correlação"><i class="fa fa-check"></i><b>1.1.4</b> Descrevendo relacionamentos lineares com correlação</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#fittingALineByLSR"><i class="fa fa-check"></i><b>1.2</b> Ajustando uma linha pela regressão de mínimos quadrados</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path=""><a href="#uma-medida-objetiva-para-encontrar-a-melhor-linha"><i class="fa fa-check"></i><b>1.2.1</b> Uma medida objetiva para encontrar a melhor linha</a></li>
<li class="chapter" data-level="1.2.2" data-path=""><a href="#condições-para-a-linha-de-mínimos-quadrados"><i class="fa fa-check"></i><b>1.2.2</b> Condições para a linha de mínimos quadrados</a></li>
<li class="chapter" data-level="1.2.3" data-path=""><a href="#findingTheLeastSquaresLineSection"><i class="fa fa-check"></i><b>1.2.3</b> Encontrar a linha dos mínimos quadrados</a></li>
<li class="chapter" data-level="1.2.4" data-path=""><a href="#interpretando-estimativas-de-parâmetros-da-linha-de-regressão"><i class="fa fa-check"></i><b>1.2.4</b> Interpretando estimativas de parâmetros da linha de regressão</a></li>
<li class="chapter" data-level="1.2.5" data-path=""><a href="#a-extrapolação-é-traiçoeira"><i class="fa fa-check"></i><b>1.2.5</b> A extrapolação é traiçoeira</a></li>
<li class="chapter" data-level="1.2.6" data-path=""><a href="#usando-r2-para-descrever-a-força-de-um-ajuste"><i class="fa fa-check"></i><b>1.2.6</b> Usando <span class="math inline">\(R^2\)</span> para descrever a força de um ajuste</a></li>
<li class="chapter" data-level="1.2.7" data-path=""><a href="#categoricalPredictorsWithTwoLevels"><i class="fa fa-check"></i><b>1.2.7</b> Preditores categóricos com dois níveis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#typesOfOutliersInLinearRegression"><i class="fa fa-check"></i><b>1.3</b> Tipos de outliers em regressão linear</a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#inferenceForLinearRegression"><i class="fa fa-check"></i><b>1.4</b> Inferência para regressão linear</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path=""><a href="#eleições-de-meio-de-mandato-e-desemprego"><i class="fa fa-check"></i><b>1.4.1</b> Eleições de meio de mandato e desemprego</a></li>
<li class="chapter" data-level="1.4.2" data-path=""><a href="#testStatisticForTheSlope"><i class="fa fa-check"></i><b>1.4.2</b> Entendendo a saída de regressão do software</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<p><img src="imagem_site_disciplina.png" /></p>
<div id="prefácio" class="section level1 unnumbered">
<h1>Prefácio</h1>
<p>Este material é baseado no livro desenvolvido pela <a href="https://www.openintro.org/">OpenIntro</a>, <a href="https://leanpub.com/openintro-statistics">OpenIntro Statistics</a>, que fornece uma introdução à estatística, a nível de graduação. O material original está disponível no <a href="https://github.com/OpenIntroStat/openintro-statistics">github</a> em formato TeX. Tanto este material adaptado, quanto o original, estão sob mesma licença no <a href="https://creativecommons.org/">Creative Commons</a>.</p>
<div align="right">
<strong>Tradução e Adaptação: <br></strong> Juliana Sena de Souza <br> Márcia Helena Barbian <br> Lisiane Priscila Roldão Selau <br> Markus Chagas Stein <br> Rodrigo Citton Padilha dos Reis
</div>
<center>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
</center>
<p><img src="before_site_disciplina.png" /></p>
</div>
<div id="linRegrForTwoVar" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introdução à Regressão Linear</h1>
<p>A regressão linear é uma técnica estatística muito poderosa. Muitas pessoas têm alguma familiaridade com regressão apenas lendo as notícias, onde gráficos com linhas retas são sobrepostos em gráficos de dispersão. Modelos lineares podem ser usados para previsão ou para avaliar se existe uma relação linear entre duas variáveis numéricas.</p>
<p>A Figura <a href="#fig:perfLinearModel">1.1</a> mostra duas variáveis cuja relação pode ser modelada perfeitamente com uma linha reta. A equação da linha é</p>
<p><span class="math display">\[\begin{eqnarray*}
y = 5 + 57.49x
\end{eqnarray*}\]</span></p>
<p>Imagine o que um relacionamento linear perfeito significaria: você saberia o valor exato de <span class="math inline">\(y\)</span> apenas conhecendo o valor de <span class="math inline">\(x\)</span>. Isso não é realista em quase todos os processos naturais. Por exemplo, se tomarmos a renda familiar <span class="math inline">\(x\)</span>, esse valor fornecerá algumas informações úteis sobre quanto apoio financeiro <span class="math inline">\(y\)</span> que a faculdade pode oferecer a um aluno em potencial. No entanto, ainda haveria variabilidade no apoio financeiro, mesmo quando se comparasse alunos cujas famílias tivessem históricos financeiros semelhantes.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">33</span>, <span class="dv">12</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">33</span><span class="sc">:</span><span class="dv">24</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">33</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">57.49</span> <span class="sc">*</span> x</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Número de ações da Target Corporation para comprar&#39;</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Custo total das ações (dólares)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:perfLinearModel"></span>
<img src="ch7_reg_simples_files/figure-html/perfLinearModel-1.png" alt="Solicitações de doze compradores separados foram colocadas simultaneamente com uma empresa comercial para comprar ações da Target Corporation (ticker TGT, April 26th, 2012), e o custo total das ações foram relatados. Porque o custo é calculado usando uma fórmula linear, o ajuste linear é perfeito." width="100%" height="30%" />
<p class="caption">
Figura 1.1: Solicitações de doze compradores separados foram colocadas simultaneamente com uma empresa comercial para comprar ações da Target Corporation (ticker TGT, April 26th, 2012), e o custo total das ações foram relatados. Porque o custo é calculado usando uma fórmula linear, o ajuste linear é perfeito.
</p>
</div>
<p>A regressão linear assume que o relacionamento entre duas variáveis, <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>, pode ser modelado por uma linha reta:</p>
<p><span class="math display" id="eq:genLinModelWNoErrorTerm">\[\begin{eqnarray}
y = \beta_0 + \beta_1x
\tag{1.1}
\end{eqnarray}\]</span>
onde <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> representam dois parâmetros do modelo (<span class="math inline">\(\beta\)</span> é a letra grega <em>beta</em>). Esses parâmetros são estimados usando dados e escrevemos suas estimativas pontuais como <span class="math inline">\(b_0\)</span> e <span class="math inline">\(b_1\)</span>. Quando usamos <span class="math inline">\(x\)</span> para prever <span class="math inline">\(y\)</span>, geralmente chamamos <span class="math inline">\(x\)</span> da variável explicativa ou <strong>preditora</strong>, e chamamos <span class="math inline">\(y\)</span> de resposta.</p>
<p>É raro que todos os dados caiam em linha reta, como visto nos três diagramas de dispersão na Figura <a href="#fig:imperfLinearModel">1.2</a>. Em cada caso, os dados caem em uma linha reta, mesmo que nenhuma das observações caia exatamente na linha. O primeiro gráfico mostra uma tendência linear descendente relativamente forte, em que a variabilidade restante nos dados ao redor da linha é menor em relação à força do relacionamento entre <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>. O segundo gráfico mostra uma tendência ascendente que, embora evidente, não é tão forte quanto a primeira. O último gráfico mostra uma tendência de queda muito fraca nos dados, tão pequena que mal podemos notar. Em cada um desses exemplos, teremos alguma incerteza em relação às nossas estimativas dos parâmetros do modelo, <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>. Por exemplo, podemos nos perguntar, devemos mover a linha para cima ou para baixo um pouco, ou devemos incliná-la mais ou menos? À medida que avançamos neste capítulo, aprenderemos diferentes critérios de ajuste linear e também aprenderemos sobre a incerteza associada às estimativas dos parâmetros do modelo.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(COL)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">49</span>, <span class="dv">376</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>], <span class="dv">16</span>, <span class="dv">33</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">14</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>], <span class="at">sd =</span> <span class="dv">12</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[<span class="dv">2</span>], <span class="dv">1052</span>, <span class="dv">300</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">1400</span> <span class="sc">+</span> <span class="dv">7</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">2</span>], <span class="at">sd =</span> <span class="dv">4020</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">20</span>, <span class="dv">8</span>), <span class="fu">runif</span>(n[<span class="dv">3</span>] <span class="sc">-</span> <span class="dv">100</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">52</span>))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="dv">140</span> <span class="sc">-</span> <span class="fl">0.15</span> <span class="sc">*</span> x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">3</span>], <span class="at">sd =</span> <span class="dv">102</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x1, y1)) <span class="sc">+</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x2, y2)) <span class="sc">+</span> </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x3, y3)) <span class="sc">+</span> </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g1, g2, g3, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:imperfLinearModel"></span>
<img src="ch7_reg_simples_files/figure-html/imperfLinearModel-1.png" alt=" Três conjuntos de dados em que um modelo linear pode ser útil, mesmo que os dados não caiam exatamente na linha." width="100%" height="30%" />
<p class="caption">
Figura 1.2:  Três conjuntos de dados em que um modelo linear pode ser útil, mesmo que os dados não caiam exatamente na linha.
</p>
</div>
<p>Também veremos exemplos neste capítulo em que encaixar uma linha reta nos dados, mesmo que haja uma relação clara entre as variáveis, não é útil. Um desses casos é mostrado na Figura <a href="#fig:notGoodAtAllForALinearModel">1.3</a> onde há uma relação muito forte entre as variáveis, embora a tendência não seja linear. Vamos discutir tendências não-lineares neste capítulo e no próximo, mas os detalhes da montagem de modelos não lineares são salvos para um curso posterior.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(COL)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, pi <span class="sc">/</span> <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">25</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(theta), <span class="at">sd =</span> <span class="dv">0</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> v<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sin</span>(theta) <span class="sc">*</span> <span class="fu">cos</span>(theta) <span class="sc">/</span> <span class="fl">9.8</span> <span class="sc">+</span> noise</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(theta <span class="sc">/</span> pi <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">90</span>, x)) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Ângulo de inclinação (graus)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Distância viajada (m)&#39;</span>) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">45</span>, <span class="at">y =</span> <span class="fl">7.5</span>, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;A melhor reta para os dados é plana (!)&#39;</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:notGoodAtAllForALinearModel"></span>
<img src="ch7_reg_simples_files/figure-html/notGoodAtAllForALinearModel-1.png" alt="Um modelo linear não é útil neste caso não linear. Esses dados são de um experimento de física introdutória." width="100%" height="30%" />
<p class="caption">
Figura 1.3: Um modelo linear não é útil neste caso não linear. Esses dados são de um experimento de física introdutória.
</p>
</div>
<div id="lineFittingResidualsCorrelation" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Ajuste linear, resíduos e correlação</h2>
<p>É útil pensar profundamente sobre o processo de ajuste linear. Nesta seção, examinamos os critérios para identificar um modelo linear e introduzir uma nova estatística, a <strong>correlação</strong>.</p>
<div id="começando-com-linhas-retas" class="section level3" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Começando com linhas retas</h3>
<p>Os diagramas de dispersão foram introduzidos no começo como técnica gráfica para apresentar duas variáveis numéricas simultaneamente. Tais gráficos permitem que a relação entre as variáveis seja examinada com facilidade. A Figura <a href="#fig:scattHeadLTotalL">1.4</a> mostra um gráfico de dispersão para o comprimento da cabeça e comprimento total de 104 gambás brushtail da Austrália. Cada ponto representa um único gambá.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(possum)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> possum) <span class="sc">+</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(totalL, headL), <span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Comprimento Total (cm)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Comprimento da Cabeça (cm)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="dv">89</span>, <span class="fl">94.1</span>), <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">89</span>, <span class="at">y =</span> <span class="fu">min</span>(headL), <span class="at">xend =</span> <span class="dv">89</span>, <span class="at">yend =</span> <span class="fl">94.1</span>), </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">min</span>(totalL), <span class="at">y =</span> <span class="fl">94.1</span>, <span class="at">xend =</span> <span class="dv">89</span>, <span class="at">yend =</span> <span class="fl">94.1</span>), </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scattHeadLTotalL"></span>
<img src="ch7_reg_simples_files/figure-html/scattHeadLTotalL-1.png" alt="Um gráfico de dispersão mostrando o comprimento da cabeça em relação ao comprimento total para 104 gambás brushtail. Um ponto representando um gambá com comprimento de cabeça de 94,1 mm e comprimento total de 89 cm é destacado." width="100%" height="30%" />
<p class="caption">
Figura 1.4: Um gráfico de dispersão mostrando o comprimento da cabeça em relação ao comprimento total para 104 gambás brushtail. Um ponto representando um gambá com comprimento de cabeça de 94,1 mm e comprimento total de 89 cm é destacado.
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&#39;brushtail_possum.jpg&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="brushtail_possum.jpg" alt="O gambá brushtail comum da Austrália. Foto: Greg Schechter" width="100%" height="30%" />
<p class="caption">
(#fig:brushtail_possum)O gambá brushtail comum da Austrália. Foto: Greg Schechter
</p>
</div>
<p>As variáveis comprimento de cabeça e total estão associadas. Os gambás com um comprimento total acima da média também tendem a ter comprimentos de cabeça acima da média. Embora o relacionamento não seja perfeitamente linear, pode ser útil explicar parcialmente a conexão entre essas variáveis com uma linha reta.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(possum)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cars)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>gr1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> possum, <span class="at">mapping =</span> <span class="fu">aes</span>(totalL, headL)) <span class="sc">+</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Comprimento Total (cm)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Comprimento da Cabeça (mm)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>gr2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> cars, <span class="at">mapping =</span> <span class="fu">aes</span>(weight, mpgCity)) <span class="sc">+</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Peso (libras)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Milhas por galão (condução na cidade)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">&#39;auto&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(gr1, gr2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scattHeadLTotalLTube"></span>
<img src="ch7_reg_simples_files/figure-html/scattHeadLTotalLTube-1.png" alt="A figura à esquerda mostra o comprimento da cabeça versus comprimento total e revela que muitos dos pontos podem ser capturados por uma faixa reta. À direita, vemos que uma faixa curva é mais apropriada no gráfico de dispersão para peso e milhas por galão do conjunto de dados carros." width="100%" height="30%" />
<p class="caption">
Figura 1.5: A figura à esquerda mostra o comprimento da cabeça versus comprimento total e revela que muitos dos pontos podem ser capturados por uma faixa reta. À direita, vemos que uma faixa curva é mais apropriada no gráfico de dispersão para peso e milhas por galão do conjunto de dados carros.
</p>
</div>
<p>Linhas retas só devem ser usadas quando os dados parecem ter um relacionamento linear, como o caso mostrado no gráfico esquerdo da Figura <a href="#fig:scattHeadLTotalLTube">1.5</a>. O gráfico direito da Figura <a href="#fig:scattHeadLTotalLTube">1.5</a> mostra um caso em que uma linha curva seria mais útil para entender a relação entre as duas variáveis.</p>
<div class="alert alert-info">
<p><strong>Cuidado com tendências curvas</strong>: Consideramos apenas modelos baseados em linhas retas neste capítulo. Se os dados mostram uma tendência não linear, como no gráfico direito da Figura <a href="#fig:scattHeadLTotalLTube">1.5</a>, técnicas mais avançadas devem ser usadas.</p>
</div>
</div>
<div id="sobrepor-uma-linha-visualmente" class="section level3" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Sobrepor uma linha visualmente</h3>
<p>Queremos descrever a relação entre as variáveis comprimento da cabeça e comprimento total no conjunto de dados do gambá usando uma linha. Neste exemplo, usaremos o comprimento total como variável preditora, <span class="math inline">\(x\)</span>, para prever o comprimento da cabeça de um gambá, <span class="math inline">\(y\)</span>. Poderíamos ajustar a relação linear a olho, como na Figura <a href="#fig:scattHeadLTotalLLine">1.6</a>. A equação para esta linha é</p>
<p><span class="math display" id="eq:headLLinModTotalL">\[\begin{eqnarray}
\hat{y} = 41 + 0.59x
\tag{1.2}
\end{eqnarray}\]</span></p>
<p>Podemos usar essa linha para discutir propriedades de <em>gambás</em>. Por exemplo, a equação prevê que um gambá com um comprimento total de 80 cm terá um comprimento de cabeça</p>
<p><span class="math display">\[\begin{align*}
\hat{y} &amp;= 41 + 0,59\times 80 \\
    &amp;= 88,2 % mm
\end{align*}\]</span></p>
<p>Um “chapéu” em <span class="math inline">\(y\)</span> é usado para significar que isso é uma estimativa. Esta estimativa pode ser vista como uma média: a equação prevê que gambás com um comprimento total de 80cm terão um comprimento médio da cabeça de 88,2mm. Ausente mais informações sobre um gambá de 80cm, a previsão para o comprimento da cabeça que usa a média é uma estimativa razoável.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(openintro)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(possum)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>these <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">42</span>, <span class="dv">3</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>temp1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>temp2 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  y2 <span class="ot">&lt;-</span> <span class="dv">41</span> <span class="sc">+</span> <span class="fl">0.59</span> <span class="sc">*</span> possum<span class="sc">$</span>totalL[these[i]]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  temp1[i,] <span class="ot">&lt;-</span> <span class="fu">rep</span>(possum<span class="sc">$</span>totalL[these[i]], <span class="dv">2</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  temp2[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(possum<span class="sc">$</span>headL[these[i]], y2)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> possum, <span class="fu">aes</span>(totalL, headL), <span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Comprimento Total (cm)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Comprimento da Cabeça (cm)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">41</span>, <span class="at">slope =</span> <span class="fl">0.59</span>) <span class="sc">+</span> </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(possum<span class="sc">$</span>totalL[these] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="fl">0.02</span>),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                 possum<span class="sc">$</span>headL[these] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="fl">0.02</span>)), <span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> temp1[,<span class="dv">1</span>], <span class="at">y =</span> temp2[,<span class="dv">1</span>], <span class="at">xend =</span> temp1[,<span class="dv">2</span>], <span class="at">yend =</span> temp2[,<span class="dv">2</span>]), </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scattHeadLTotalLLine"></span>
<img src="ch7_reg_simples_files/figure-html/scattHeadLTotalLLine-1.png" alt="Um modelo linear razoável foi ajustado para representar a relação entre comprimento da cabeça e comprimento total." width="100%" height="30%" />
<p class="caption">
Figura 1.6: Um modelo linear razoável foi ajustado para representar a relação entre comprimento da cabeça e comprimento total.
</p>
</div>
</div>
<div id="resíduos" class="section level3" number="1.1.3">
<h3><span class="header-section-number">1.1.3</span> Resíduos</h3>
<p></p>
<p><strong>Resíduos</strong> são as variações restantes nos dados após a contabilização do ajuste do modelo:</p>
<p><span class="math display">\[\begin{align*}
\text{Dados} = \text{Ajuste} + \text{Resíduos}
\end{align*}\]</span></p>
<p>Cada observação terá um resíduo. Se uma observação estiver acima da linha de regressão, então seu resíduo, a distância vertical da observação até a linha, é positivo. Observações abaixo da linha têm resíduos negativos. Um objetivo ao escolher o modelo linear correto é que esses resíduos sejam tão pequenos quanto possível.</p>
<p>Três observações são anotadas especialmente na Figura <a href="#fig:scattHeadLTotalLLine">1.6</a>. A observação marcada por um <span class="math inline">\(\times\)</span> tem um pequeno resíduo negativo de cerca de -1; a observação marcada por <span class="math inline">\(+\)</span> tem um grande resíduo de cerca de +7; e a observação marcada por <span class="math inline">\(\triangle\)</span> tem um resíduo moderado de cerca de -4. O tamanho de um resíduo é geralmente discutido em termos de seu valor absoluto. Por exemplo, o resíduo de <span class="math inline">\(\triangle\)</span> é maior que o de <span class="math inline">\(\times\)</span> porque <span class="math inline">\(|-4|\)</span> é maior que <span class="math inline">\(|-1|\)</span>.</p>
<div class="alert alert-info">
<p><strong>Resíduos: diferença entre observado e esperado</strong>: O resíduo da i observação <span class="math inline">\((x_i, y_i)\)</span> é a diferença da resposta observada (<span class="math inline">\(y_i\)</span>) e a resposta que preveríamos com base no ajuste do modelo (<span class="math inline">\(\hat{y} _i\)</span>):</p>
<p><span class="math display">\[\begin{eqnarray*}
e_i = y_i - \hat{y}_i
\end{eqnarray*}\]</span></p>
<p>Nós tipicamente identificamos <span class="math inline">\(\hat{y}_i\)</span> conectando <span class="math inline">\(x_i\)</span> no modelo.}</p>
</div>

<div class="example">
<span id="exm:unnamed-chunk-2" class="example"><strong>Exemplo 1.1  </strong></span>O ajuste linear mostrado na Figura <a href="#fig:scattHeadLTotalLLine">1.6</a> é dado como <span class="math inline">\(\hat{y} = 41 + 0,59x\)</span>. Com base nessa linha, calcule formalmente o resíduo da observação <span class="math inline">\((77,0, 85,3)\)</span>. Esta observação é denotada por <span class="math inline">\(\times\)</span> no gráfico. Verifique com base na estimativa visual anterior, -1.
</div>
<p>Primeiro calculamos o valor previsto do ponto <span class="math inline">\(\times\)</span> baseado no modelo:</p>
<p><span class="math display">\[\begin{eqnarray*}
\hat{y}_{\times} = 41+0,59x_{\times} = 41+0,59\times 77,0 = 86,4
\end{eqnarray*}\]</span></p>
<p>Em seguida, calculamos a diferença entre o comprimento real da cabeça e o comprimento da cabeça previsto:</p>
<p><span class="math display">\[\begin{eqnarray*}
e_{\times} = y_{\times} - \hat{y}_{\times} = 85,3 -  86,4 = -1,1
\end{eqnarray*}\]</span></p>
<p>Isso é muito próximo da estimativa visual de -1.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-3" class="exercise"><strong>Prática Orientada 1.1  </strong></span>Se um modelo subestima uma observação, o resíduo será positivo ou negativo? E se superestima a observação?<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</div>
<hr />
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-4" class="exercise"><strong>Prática Orientada 1.2  </strong></span>Calcule os resíduos para as observações <span class="math inline">\((85,0, 98,6)\)</span> (<span class="math inline">\(+\)</span> na figura) e <span class="math inline">\((95,5, 94,0)\)</span> (<span class="math inline">\(\triangle\)</span>) usando a relação linear <span class="math inline">\(\hat{y} = 41 + 0,59x\)</span>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
</div>
<hr />
<p>Resíduos são úteis para avaliar quão bem um modelo linear se ajusta a um conjunto de dados. Costumamos exibi-los em um <strong>gráfico de resíduos</strong> como o mostrado na Figura <a href="#fig:scattHeadLTotalLResidualPlot">1.7</a> para a linha de regressão da Figura <a href="#fig:scattHeadLTotalLLine">1.6</a>. Os resíduos são plotados em seus locais horizontais originais, mas com a coordenada vertical como resíduo. Por exemplo, o ponto <span class="math inline">\((85,0,98,6)_{+}\)</span> tinha um resíduo de 7,45, então no gráfico de resíduos ele é colocado em <span class="math inline">\((85,0, 7,45)\)</span>. Criar um gráfico de resíduos é como derrubar o gráfico de dispersão para que a linha de regressão seja horizontal.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(possum)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>these <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">42</span>, <span class="dv">3</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>y.extra <span class="ot">&lt;-</span> <span class="fl">0.59</span> <span class="sc">*</span> possum<span class="sc">$</span>totalL[these] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="fl">0.01</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">lm</span>(headL <span class="sc">~</span> totalL, possum)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(possum<span class="sc">$</span>totalL, g<span class="sc">$</span>residuals), <span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Comprimento Total (cm)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Residuals&#39;</span>) <span class="sc">+</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(possum<span class="sc">$</span>totalL[these] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.01</span>),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                 possum<span class="sc">$</span>headL[these] <span class="sc">-</span> (<span class="dv">41</span> <span class="sc">+</span> y.extra)), <span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:scattHeadLTotalLResidualPlot"></span>
<img src="ch7_reg_simples_files/figure-html/scattHeadLTotalLResidualPlot-1.png" alt="Gráfico resíduo para o modelo do comprimento total x comprimento da cabeça" width="100%" height="30%" />
<p class="caption">
Figura 1.7: Gráfico resíduo para o modelo do comprimento total x comprimento da cabeça
</p>
</div>

<div class="example">
<span id="exm:unnamed-chunk-5" class="example"><strong>Exemplo 1.2  </strong></span>Um propósito dos gráficos de resíduos é identificar características ou padrões ainda aparentes nos dados após a montagem de um modelo. Figura <a href="#fig:sampleLinesAndResPlots">1.8</a> mostra três gráficos de dispersão com modelos lineares na primeira linha e gráficos de resíduos na segunda linha. Você consegue identificar algum padrão remanescente nos resíduos?
</div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n1[<span class="dv">1</span>])</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">8</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n1[<span class="dv">1</span>])</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n2[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="dv">2</span>, <span class="fl">2.1</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> x2<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n2[<span class="dv">1</span>])</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>n3 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n3[<span class="dv">1</span>])</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="sc">*</span> x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n3[<span class="dv">1</span>])</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>y3[y3 <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.5</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x1,y1)) <span class="sc">+</span> </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x2,y2)) <span class="sc">+</span> </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x3,y3)) <span class="sc">+</span> </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y1 <span class="sc">~</span> x1)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y2 <span class="sc">~</span> x2)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y3 <span class="sc">~</span> x3)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x1,g1<span class="sc">$</span>residuals)) <span class="sc">+</span> </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x2,g2<span class="sc">$</span>residuals)) <span class="sc">+</span> </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x3,g3<span class="sc">$</span>residuals)) <span class="sc">+</span> </span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(gridExtra)</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, p5, p6, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:sampleLinesAndResPlots"></span>
<img src="ch7_reg_simples_files/figure-html/sampleLinesAndResPlots-1.png" alt="Dados amostrais com suas melhores linhas de ajuste (linha superior) e seus gráficos de resíduos correspondentes (linha inferior)." width="100%" height="30%" />
<p class="caption">
Figura 1.8: Dados amostrais com suas melhores linhas de ajuste (linha superior) e seus gráficos de resíduos correspondentes (linha inferior).
</p>
</div>
<p>No primeiro conjunto de dados (primeira coluna), os resíduos não mostram padrões óbvios. Os resíduos parecem estar espalhados aleatoriamente ao redor da linha tracejada que representa o 0.</p>
<p>O segundo conjunto de dados mostra um padrão nos resíduos. Há alguma curvatura no gráfico de dispersão, que é mais óbvia no gráfico de resíduos. Não devemos usar uma linha reta para modelar esses dados. Em vez disso, uma técnica mais avançada deve ser usada.</p>
<p>O último gráfico mostra muito pouca tendência ascendente e os resíduos também não mostram padrões óbvios. É razoável tentar ajustar um modelo linear aos dados. No entanto, não está claro se há evidências estatisticamente significativas de que o parâmetro de inclinação é diferente de zero. A estimativa pontual do parâmetro de inclinação, rotulado <span class="math inline">\(b_1\)</span>, não é zero, mas podemos nos perguntar se isso pode ser devido ao acaso. Vamos abordar esse tipo de cenário na Seção <a href="#inferenceForLinearRegression">1.4</a>.</p>
</div>
<div id="descrevendo-relacionamentos-lineares-com-correlação" class="section level3" number="1.1.4">
<h3><span class="header-section-number">1.1.4</span> Descrevendo relacionamentos lineares com correlação</h3>
<div class="alert alert-info">
<p><strong>Correlação: força de um relacionamento linear</strong>: A <strong>correlação</strong>, que sempre recebe valores entre -1 e 1, descreve a força do relacionamento linear entre duas variáveis. Denotamos a correlação por <span class="math inline">\(R\)</span>.</p>
</div>
<p>Podemos calcular a correlação usando uma fórmula, assim como fizemos com a média e o desvio padrão da amostra. No entanto, esta fórmula é bastante complexa,<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> então geralmente executamos os cálculos em um computador ou calculadora.</p>
<p>A Figura <a href="#fig:posNegCorPlots">1.9</a> mostra oito gráficos e suas correlações correspondentes. Somente quando o relacionamento é perfeitamente linear a correlação é -1 ou 1. Se o relacionamento for forte e positivo, a correlação será próxima de +1. Se for forte e negativo, será próximo de -1. Se não houver relação linear aparente entre as variáveis, a correlação será próxima de zero.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(possum)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plots_  <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">mean</span>(x), <span class="at">y =</span> <span class="fu">min</span>(y), </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;R = &#39;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(x,y),<span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># _____ Line 1 _____ #</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="dv">2</span>, <span class="fl">2.1</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>], <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="dv">2</span>, <span class="fl">2.1</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>], <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n[<span class="dv">1</span>])</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> x3</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>y3[y3 <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.5</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># _____ Line 2 _____ #</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="dv">2</span>, <span class="fl">2.1</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> x4 <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>], <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n[<span class="dv">1</span>], <span class="sc">-</span><span class="fl">4.8</span>, <span class="fl">4.8</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="sc">-</span>x5 <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>], <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n[<span class="dv">1</span>])</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>y6 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">9</span> <span class="sc">*</span> x6 <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>])</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>x7 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n[<span class="dv">1</span>])</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>y7 <span class="ot">&lt;-</span> <span class="sc">-</span>x7</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>y7[y7 <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.5</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co"># plots </span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="fu">plots_</span>(x,y), <span class="fu">plots_</span>(possum<span class="sc">$</span>totalL, possum<span class="sc">$</span>headL), </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">plots_</span>(x2, y2), <span class="fu">plots_</span>(x3, y3), <span class="fu">plots_</span>(x4, y4), </span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">plots_</span>(x5, y5), <span class="fu">plots_</span>(x6, y6), <span class="fu">plots_</span>(x7, y7), <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:posNegCorPlots"></span>
<img src="ch7_reg_simples_files/figure-html/posNegCorPlots-1.png" alt="Amostra de gráficos de dispersão e suas correlações. A primeira linha mostra variáveis com um relacionamento positivo, representado pela tendência para cima e para a direita. A segunda linha mostra variáveis com tendência negativa, em que um grande valor em uma variável é associado a um valor baixo na outra." width="100%" height="30%" />
<p class="caption">
Figura 1.9: Amostra de gráficos de dispersão e suas correlações. A primeira linha mostra variáveis com um relacionamento positivo, representado pela tendência para cima e para a direita. A segunda linha mostra variáveis com tendência negativa, em que um grande valor em uma variável é associado a um valor baixo na outra.
</p>
</div>
<p>A correlação destina-se a quantificar a força de uma tendência linear. Tendências não-lineares, mesmo quando fortes, às vezes produzem correlações que não refletem a força do relacionamento. Veja três desses exemplos na Figura <a href="#fig:corForNonLinearPlots">1.10</a>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plots_  <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y), <span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">mean</span>(x), <span class="at">y =</span> <span class="fu">min</span>(y), </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;R = &#39;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(x,y),<span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="fl">2.2</span>), <span class="dv">2</span>, <span class="fl">2.1</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>], <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">2</span>, <span class="sc">-</span><span class="dv">20</span>, <span class="fl">10.2</span>), <span class="dv">2</span>, <span class="fl">2.1</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="sc">-</span>x2<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> <span class="dv">10</span> <span class="sc">*</span> x2<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">100</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>], <span class="at">sd =</span> <span class="dv">120</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n[<span class="dv">1</span>], <span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fl">0.25</span> <span class="sc">*</span> (x3 <span class="sc">&gt;</span> <span class="dv">3</span>) <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> (x3 <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">1.7</span> <span class="sc">*</span> (x3 <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">+</span> (x3 <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">c</span>(x3, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="fl">0.071</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">c</span>(y3, <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span> noise</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="fu">plots_</span>(x,y), <span class="fu">plots_</span>(x2,y2), <span class="fu">plots_</span>(x3,y3), <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:corForNonLinearPlots"></span>
<img src="ch7_reg_simples_files/figure-html/corForNonLinearPlots-1.png" alt="Amostra de gráficos de dispersão e suas correlações. Em cada caso, existe uma forte relação entre as variáveis. No entanto, a correlação não é muito forte e a relação não é linear." width="100%" height="30%" />
<p class="caption">
Figura 1.10: Amostra de gráficos de dispersão e suas correlações. Em cada caso, existe uma forte relação entre as variáveis. No entanto, a correlação não é muito forte e a relação não é linear.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-6" class="exercise"><strong>Prática Orientada 1.3  </strong></span>Parece que nenhuma linha reta caberia em nenhum dos conjuntos de dados representados na Figura <a href="#fig:corForNonLinearPlots">1.10</a>. Tente desenhar curvas não lineares em cada plotagem. Depois de criar uma curva para cada uma, descreva o que é importante em seu ajuste.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>
</div>
<hr />
</div>
</div>
<div id="fittingALineByLSR" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Ajustando uma linha pela regressão de mínimos quadrados</h2>
<p>A adaptação de modelos lineares visualmente está aberta a críticas, pois se baseia em uma preferência individual. Nesta seção, usamos <strong>regressão por mínimos quadrados</strong> como uma abordagem mais rigorosa.</p>
<p>Esta seção considera os dados da renda familiar e do <em>gift aid</em> de uma amostra aleatória de cinquenta alunos da turma de calouros de 2011 do Elmhurst College em Illinois<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. <em>Gift Aid</em> é uma ajuda financeira que não precisa ser paga de volta, ao contrário de um empréstimo. Um gráfico de dispersão dos dados é mostrado na Figura <a href="#fig:elmhurstScatterW2Lines">1.11</a> junto com dois ajustes lineares. As linhas seguem uma tendência negativa nos dados; os alunos que têm maior renda familiar tendem a ter menor ajuda da universidade.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(COL)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(elmhurst)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> elmhurst</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">lm</span>(d<span class="sc">$</span>gift_aid <span class="sc">~</span> d<span class="sc">$</span>family_income)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>loss <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, d) {</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> d<span class="sc">$</span>family_income</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(d<span class="sc">$</span>gift_aid <span class="sc">-</span> p))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>a      <span class="ot">&lt;-</span> <span class="fu">round</span>(g<span class="sc">$</span>coef[<span class="dv">1</span>], <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.001</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>b      <span class="ot">&lt;-</span> <span class="fu">round</span>(g<span class="sc">$</span>coef[<span class="dv">2</span>], <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.0001</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>mins   <span class="ot">&lt;-</span> <span class="fu">c</span>(a[<span class="dv">1</span>], b[<span class="dv">1</span>])</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>theMin <span class="ot">&lt;-</span> <span class="fu">loss</span>(a[<span class="dv">1</span>], b[<span class="dv">1</span>], d)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>pb     <span class="ot">&lt;-</span> <span class="fu">txtProgressBar</span>(<span class="dv">1</span>, <span class="fu">length</span>(a), <span class="at">style=</span><span class="dv">3</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a)) {</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(b)) {</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    hold <span class="ot">&lt;-</span> <span class="fu">loss</span>(a[i], b[j], d)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (hold <span class="sc">&lt;</span> theMin) {</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      mins <span class="ot">&lt;-</span> <span class="fu">c</span>(a[i],b[j])</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      theMin <span class="ot">&lt;-</span> hold</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co"># elmhurstScatterW2Lines</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="at">mapping =</span> <span class="fu">aes</span>(family_income, gift_aid)) <span class="sc">+</span> </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Renda Familiar ($1000s)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Auxílio-presente da </span><span class="sc">\n</span><span class="st">universidade ($1000s)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> mins[<span class="dv">2</span>], <span class="at">intercept =</span> mins[<span class="dv">1</span>], <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:elmhurstScatterW2Lines"></span>
<img src="ch7_reg_simples_files/figure-html/elmhurstScatterW2Lines-1.png" alt="Auxílio presente e renda familiar para uma amostra aleatória de 50 alunos iniciantes do Elmhurst College. Duas linhas são ajustadas aos dados, sendo a linha sólida a regressão por mínimos quadrados." width="100%" height="30%" />
<p class="caption">
Figura 1.11: Auxílio presente e renda familiar para uma amostra aleatória de 50 alunos iniciantes do Elmhurst College. Duas linhas são ajustadas aos dados, sendo a linha sólida a regressão por mínimos quadrados.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-7" class="exercise"><strong>Prática Orientada 1.4  </strong></span>A correlação é positiva ou negativa na Figura <a href="#fig:elmhurstScatterW2Lines">1.11</a>?<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>
</div>
<hr />
<div id="uma-medida-objetiva-para-encontrar-a-melhor-linha" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Uma medida objetiva para encontrar a melhor linha</h3>
<p>Começamos por pensar sobre o que queremos dizer com “melhor.” Matematicamente, queremos uma linha que tenha pequenos resíduos. Talvez nosso critério possa minimizar a soma das magnitudes residuais:</p>
<p><span class="math display" id="eq:sumOfAbsoluteValueOfResiduals">\[\begin{eqnarray}
|e_1| + |e_2| + \dots + |e_n|
\tag{1.3}
\end{eqnarray}\]</span></p>
<p>o que poderíamos realizar com um programa de computador. A linha tracejada resultante mostrada na Figura <a href="#fig:elmhurstScatterW2Lines">1.11</a> demonstra que esse ajuste pode ser bastante razoável. No entanto, uma prática mais comum é escolher a linha que minimiza a soma dos resíduos quadrados:</p>
<p><span class="math display" id="eq:sumOfSquaresForResiduals">\[\begin{eqnarray}
e_{1}^2 + e_{2}^2 + \dots + e_{n}^2
\tag{1.4}
\end{eqnarray}\]</span></p>
<p>A linha que minimiza os <strong>mínimos quadrados</strong> é representada como a linha sólida na Figura <a href="#fig:elmhurstScatterW2Lines">1.11</a>. Isso é comumente chamado de <strong>linha de mínimos quadrados</strong>. A seguir estão três possíveis razões para escolher Critério <a href="#eq:sumOfSquaresForResiduals">(1.4)</a> sobre o Critério <a href="#eq:sumOfAbsoluteValueOfResiduals">(1.3)</a>:</p>
<ul>
<li><p>É o método mais comumente usado.</p></li>
<li><p>Computar a linha com base no Critério <a href="#eq:sumOfSquaresForResiduals">(1.4)</a> é muito mais fácil à mão e tem implementado na maioria dos softwares estatísticos.</p></li>
<li><p>Em muitas aplicações, um resíduo duas vezes maior que outro é quatro vezes mais problemático. Por exemplo, estar desviado por 4 é geralmente mais que duas vezes pior quanto estar desviado por 2. Usar o quadrado dos resíduos responde por essa discrepância.</p></li>
</ul>
<p>As duas primeiras razões são em grande parte por tradição e conveniência; a última razão explica por que Critério <a href="#eq:sumOfSquaresForResiduals">(1.4)</a> é geralmente mais útil.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
</div>
<div id="condições-para-a-linha-de-mínimos-quadrados" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Condições para a linha de mínimos quadrados</h3>
<p>Ao encaixar uma linha de mínimos quadrados, geralmente exigimos</p>
<ul>
<li><p><strong>Linearidade.</strong> Os dados devem mostrar uma tendência linear. Se houver uma tendência não linear (por exemplo, gráfico esquerdo da Figura <a href="#fig:whatCanGoWrongWithLinearModel">1.12</a>), um método de regressão avançado de outro livro ou curso posterior deve ser aplicado.</p></li>
<li><p><strong>Resíduos quase normais.</strong> Geralmente os resíduos devem ser quase normais. Quando esta condição é considerada irracional, geralmente é por causa de discrepâncias ou preocupações sobre pontos influentes, que discutiremos com mais profundidade na Seção <a href="#typesOfOutliersInLinearRegression">1.3</a>. Um exemplo de resíduos não normais é mostrado no segundo gráfico da Figura <a href="#fig:whatCanGoWrongWithLinearModel">1.12</a>.</p></li>
<li><p><strong>Variabilidade constante.</strong> A variabilidade de pontos ao redor da linha dos mínimos quadrados permanece praticamente constante. Um exemplo de variabilidade não constante é mostrado no terceiro gráfico da Figura <a href="#fig:whatCanGoWrongWithLinearModel">1.12</a>.</p></li>
<li><p><strong>Observações independentes.</strong> Seja cauteloso ao aplicar a regressão a dados de <strong>séries temporais</strong>, que são observações sequenciais no tempo, como o preço de uma ação por dia. Tais dados podem ter uma estrutura subjacente que deve ser considerada em um modelo e análise. Um exemplo de um conjunto de dados em que observações sucessivas não são independentes é mostrado no quarto gráfico da Figura <a href="#fig:whatCanGoWrongWithLinearModel">1.12</a>. Existem também outros casos em que as correlações dentro dos dados são importantes.</p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pls <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x,g<span class="sc">$</span>residuals)) <span class="sc">+</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># load the makeTube function (ch7 folder)</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="sc">*</span> x <span class="sc">-</span> <span class="dv">20</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x,y)) <span class="sc">+</span> </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>, <span class="sc">-</span><span class="fl">0.46</span>, <span class="sc">-</span><span class="fl">0.091</span>, <span class="fu">runif</span>(<span class="dv">97</span>))</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x2))</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>y2[<span class="dv">2</span>] <span class="ot">&lt;-</span> y2[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">8</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>y2[<span class="dv">1</span>] <span class="ot">&lt;-</span> y2[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x2,y2)) <span class="sc">+</span> </span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">*</span> x3 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x3), <span class="at">sd =</span> x3)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x3,y3)) <span class="sc">+</span> </span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(Ecdat)</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Macrodat)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Macrodat[,<span class="dv">1</span>]),<span class="fu">as.numeric</span>(Macrodat[,<span class="dv">1</span>]))) <span class="sc">+</span> </span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="fu">pls</span>(x,y), <span class="fu">pls</span>(x2,y2), <span class="fu">pls</span>(x3,y3), </span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">pls</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Macrodat[,<span class="dv">1</span>]),<span class="at">y =</span> <span class="fu">as.numeric</span>(Macrodat[,<span class="dv">1</span>])), <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:whatCanGoWrongWithLinearModel"></span>
<img src="ch7_reg_simples_files/figure-html/whatCanGoWrongWithLinearModel-1.png" alt="Quatro exemplos mostrando quando os métodos neste capítulo são insuficientes para aplicar aos dados. No gráfico esquerdo, uma linha reta não se ajusta aos dados. No segundo gráfico, existem outliers; dois pontos à esquerda estão relativamente distantes do resto dos dados, e um desses pontos está muito longe da linha. No terceiro gráfico, a variabilidade dos dados ao redor da linha aumenta com valores maiores de x. No último gráfico, é mostrado um conjunto de dados de séries temporais, em que as observações sucessivas são altamente correlacionadas." width="100%" height="30%" />
<p class="caption">
Figura 1.12: Quatro exemplos mostrando quando os métodos neste capítulo são insuficientes para aplicar aos dados. No gráfico esquerdo, uma linha reta não se ajusta aos dados. No segundo gráfico, existem outliers; dois pontos à esquerda estão relativamente distantes do resto dos dados, e um desses pontos está muito longe da linha. No terceiro gráfico, a variabilidade dos dados ao redor da linha aumenta com valores maiores de x. No último gráfico, é mostrado um conjunto de dados de séries temporais, em que as observações sucessivas são altamente correlacionadas.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-8" class="exercise"><strong>Prática Orientada 1.5  </strong></span>Deveríamos ter dúvidas sobre a aplicação da regressão de mínimos quadrados aos dados do Elmhurst na Figura <a href="#fig:elmhurstScatterW2Lines">1.11</a>?<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>
</div>
<hr />
</div>
<div id="findingTheLeastSquaresLineSection" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Encontrar a linha dos mínimos quadrados</h3>
<p>Para os dados de <em>Elmhurst</em>, poderíamos escrever a equação da linha de regressão de mínimos quadrados como</p>
<p><span class="math display">\[\begin{eqnarray*}
\widehat{ajuda} = \beta_0 + \beta_{1}\times ganho\_\hspace{0.3mm}familiar
\end{eqnarray*}\]</span></p>
<p>Aqui, a equação é configurada para prever o <em>gift-aid</em> com base na renda familiar de um aluno, o que seria útil para os alunos que considerassem <em>Elmhurst.</em> Esses dois valores, <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>, são os <strong>parâmetros</strong> da linha de regressão.</p>
<p>Como nos Capítulos 4-6, os parâmetros são estimados usando dados observados. Na prática, essa estimativa é feita usando um computador da mesma forma que outras estimativas, como uma média amostral, podem ser estimadas usando um computador ou uma calculadora. No entanto, também podemos encontrar as estimativas dos parâmetros aplicando duas propriedades da linha de mínimos quadrados:</p>
<ul>
<li>A inclinação da linha dos mínimos quadrados pode ser estimada por</li>
</ul>
<p><span class="math display" id="eq:slopeOfLSRLine">\[\begin{eqnarray}
b_1 = \frac{s_y}{s_x} R
\tag{1.5}
\end{eqnarray}\]</span></p>
<p>onde <span class="math inline">\(R\)</span> é a correlação entre as duas variáveis, e <span class="math inline">\(s_x\)</span> e <span class="math inline">\(s_y\)</span> são os desvios padrão da amostra da variável explicativa (variável no eixo horizontal) e resposta (variável no eixo vertical), respectivamente.</p>
<ul>
<li>Se <span class="math inline">\(\bar{x}\)</span> for a média da variável horizontal (dos dados) e <span class="math inline">\(\bar{y}\)</span> é a média da variável vertical, então o ponto <span class="math inline">\((\bar{x}, \bar{y})\)</span> está nos mínimos quadrados linha.</li>
</ul>
<p>Usamos <span class="math inline">\(b_0\)</span> e <span class="math inline">\(b_1\)</span> para representar as estimativas pontuais dos parâmetros <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-9" class="exercise"><strong>Prática Orientada 1.6  </strong></span>A Tabela <a href="#tab:summaryStatsOfSATGPAData">1.1</a> mostra as médias amostrais para a renda familiar e <em>gift-aid</em> em $101.800 e $19.940, respectivamente. Plote o ponto <span class="math inline">\((101,8, 19,94)\)</span> na Figura <a href="#fig:elmhurstScatterW2Lines">1.11</a> para verificar se ele cai na linha de mínimos quadrados (a linha sólida).<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>
</div>
<hr />
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">101.8</span>, <span class="fl">19.94</span>, <span class="fl">63.2</span>, <span class="fl">5.46</span>, <span class="st">&#39; &#39;</span>, <span class="st">&#39;R = -0.499&#39;</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;renda familiar, em $1000s (x)&#39;</span>, <span class="st">&#39;gift aid, em $1000s (y)&#39;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;média&#39;</span>, <span class="st">&#39;dp&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table1, <span class="at">align =</span> <span class="st">&#39;r&#39;</span>, <span class="at">caption =</span> <span class="st">&#39;Estatísticas resumidas para renda familiar e gift aid.&#39;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:summaryStatsOfSATGPAData">Tabela 1.1: </span>Estatísticas resumidas para renda familiar e gift aid.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">renda familiar, em $1000s (x)</th>
<th align="right">gift aid, em $1000s (y)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">média</td>
<td align="right">101.8</td>
<td align="right">19.94</td>
</tr>
<tr class="even">
<td align="left">dp</td>
<td align="right">63.2</td>
<td align="right">5.46</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="right"></td>
<td align="right">R = -0.499</td>
</tr>
</tbody>
</table>
<hr />

<div class="exercise">
<span id="exr:findingTheSlopeOfTheLSRLineForIncomeAndAid" class="exercise"><strong>Prática Orientada 1.7  </strong></span>Usando as estatísticas resumidas na Tabela <a href="#tab:summaryStatsOfSATGPAData">1.1</a>, calcular a inclinação para a linha de regressão do gift-aid contra a renda familiar.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>
</div>
<hr />
<p>Você pode se lembrar da forma de uma linha da aula de matemática (outra forma comum é com <strong>coeficiente linear e angular</strong>). Dada a inclinação de uma linha e um ponto na linha, <span class="math inline">\((x_0, y_0)\)</span>, a equação da linha pode ser escrita como</p>
<p><span class="math display" id="eq:pointSlopeFormForALine">\[\begin{eqnarray}
y - y_0 = Inclinação \times (x - x_0)
\tag{1.6}
\end{eqnarray}\]</span></p>
<p>Um exercício comum para se tornar mais familiarizado com os fundamentos da regressão de mínimos quadrados é usar as estatísticas de resumo básicas e a forma <em>ponto e inclinação</em> para produzir a linha de mínimos quadrados.</p>
<div class="alert alert-info">
<p><strong>Identificando a linha dos mínimos quadrados a partir das estatísticas de resumo</strong>: Passos para identificar a linha de mínimos quadrados a partir das estatísticas de resumo:</p>
<ul>
<li><p>Estimar o parâmetro de inclinação, <span class="math inline">\(b_1\)</span>, usando a Equação <a href="#eq:slopeOfLSRLine">(1.5)</a>.</p></li>
<li><p>Observando que o ponto <span class="math inline">\((\bar{x}, \bar{y})\)</span> está na linha de mínimos quadrados, use <span class="math inline">\(x_0=\bar{x}\)</span> e <span class="math inline">\(y_0=\bar{y}\)</span> junto com a inclinação <span class="math inline">\(b_1\)</span> na equação da reta: <span class="math display">\[y - \bar{y} = b_1 (x - \bar{x})\]</span></p></li>
<li><p>Simplifique a equação.</p></li>
</ul>
</div>

<div class="example">
<span id="exm:exampleToFindLSRLineOfElmhurstData" class="example"><strong>Exemplo 1.3  </strong></span>Usando o ponto <span class="math inline">\((101,8, 19,94)\)</span> das médias amostrais e a estimativa de inclinação <span class="math inline">\(b_1 = -0,0431\)</span> da Prática Orientada <a href="#exr:findingTheSlopeOfTheLSRLineForIncomeAndAid">1.7</a>, encontre a linha dos mínimos quadrados para prever o auxilio com base na renda familiar.
</div>
<p>Aplique a equação da reta usando <span class="math inline">\((101.8, 19.94)\)</span> e a inclinação <span class="math inline">\(b_1 = -0,0431\)</span>:</p>
<p><span class="math display">\[\begin{align*}
y - y_0     &amp;= b_1 (x - x_0) \\
y - 19.94  &amp;= -0.0431(x - 101.8)
\end{align*}\]</span></p>
<p>Expandindo o lado direito e, em seguida, adicionando 19,94 para cada lado, a equação simplifica:
<span class="math display">\[\widehat{auxilio} = 24.3 - 0.0431 \times renda\_\hspace{0.3mm}familiar\]</span>
Aqui nós substituímos <span class="math inline">\(y\)</span> por <span class="math inline">\(\widehat{auxilio}\)</span> e <span class="math inline">\(x\)</span> por <span class="math inline">\(renda\_\hspace{0.3mm}familiar\)</span> para colocar a equação no contexto.</p>
<p>Mencionamos anteriormente que um computador é geralmente usado para calcular a linha de mínimos quadrados. Uma tabela de resumo baseada na saída do computador é mostrada na Tabela <a href="#tab:rOutputForIncomeAidLSRLine">1.2</a> para os dados do <em>Elmhurst.</em> A primeira coluna de números fornece estimativas para <span class="math inline">\({b} _0\)</span> e <span class="math inline">\({b} _1\)</span>, respectivamente. Compare-os com o resultado do Exemplo <a href="#exm:exampleToFindLSRLineOfElmhurstData">1.3</a>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">lm</span>(d<span class="sc">$</span>gift_aid <span class="sc">~</span> d<span class="sc">$</span>family_income)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">summary</span>(g)<span class="sc">$</span>coefficients)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(temp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Estimativa&#39;</span>, <span class="st">&#39;Erro Padrão&#39;</span>, <span class="st">&#39;valor t&#39;</span>, <span class="st">&#39;Pr(&gt;|t|)&#39;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(temp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;(Interceptio)&#39;</span>, <span class="st">&#39;Renda Familiar&#39;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp, <span class="at">align =</span> <span class="st">&#39;c&#39;</span>, <span class="at">caption =</span> <span class="st">&#39;Resumo dos mínimos quadrados adequados aos dados do Elmhurst.&#39;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:rOutputForIncomeAidLSRLine">Tabela 1.2: </span>Resumo dos mínimos quadrados adequados aos dados do Elmhurst.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Estimativa</th>
<th align="center">Erro Padrão</th>
<th align="center">valor t</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Interceptio)</td>
<td align="center">24.3193290</td>
<td align="center">1.2914503</td>
<td align="center">18.831022</td>
<td align="center">0.0000000</td>
</tr>
<tr class="even">
<td align="left">Renda Familiar</td>
<td align="center">-0.0430717</td>
<td align="center">0.0108095</td>
<td align="center">-3.984621</td>
<td align="center">0.0002289</td>
</tr>
</tbody>
</table>

<div class="example">
<span id="exm:unnamed-chunk-10" class="example"><strong>Exemplo 1.4  </strong></span>xamine a segunda, terceira e quarta colunas da Tabela <a href="#tab:rOutputForIncomeAidLSRLine">1.2</a>. Você consegue adivinhar o que elas representam?}
</div>
<p>Vamos descrever o significado das colunas usando a segunda linha, que corresponde a <span class="math inline">\(\beta_1\)</span>. A primeira coluna fornece a estimativa pontual para <span class="math inline">\(\beta_1\)</span>, como calculamos em um exemplo anterior: -0,0431. A segunda coluna é um erro padrão para esta estimativa pontual: 0,0108. A terceira coluna é uma estatística do teste-<span class="math inline">\(t\)</span> para a hipótese nula de que <span class="math inline">\(\beta_1=0\)</span>: <span class="math inline">\(T = -3,98\)</span>. A última coluna é o p-valor para a estatística do teste-<span class="math inline">\(t\)</span> para a hipótese nula <span class="math inline">\(\beta_1=0\)</span> e uma hipótese alternativa bilateral: 0,0002. Vamos entrar em mais desses detalhes na Seção <a href="#inferenceForLinearRegression">1.4</a>.</p>

<div class="example">
<span id="exm:unnamed-chunk-11" class="example"><strong>Exemplo 1.5  </strong></span>Suponha que um estudante do ensino médio esteja considerando o Elmhurst College. Ele pode simplesmente usar a equação linear que calculamos para calcular sua ajuda financeira da universidade?
</div>
<p>Ele pode usá-lo como uma estimativa, embora alguns qualificadores sobre essa abordagem sejam importantes. Primeiro, todos os dados são provenientes de uma turma de primeiro ano, e a forma como a ajuda é determinada pela universidade pode mudar de ano para ano. Em segundo lugar, a equação fornecerá uma estimativa imperfeita. Enquanto a equação linear é boa em capturar a tendência nos dados, nenhuma ajuda individual do aluno será perfeitamente prevista.</p>
</div>
<div id="interpretando-estimativas-de-parâmetros-da-linha-de-regressão" class="section level3" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Interpretando estimativas de parâmetros da linha de regressão</h3>
<p>A interpretação de parâmetros em um modelo de regressão é frequentemente uma das etapas mais importantes da análise.</p>

<div class="example">
<span id="exm:unnamed-chunk-12" class="example"><strong>Exemplo 1.6  </strong></span>As estimativas da inclinação e intercepto para os dados do Elmhurst são -0,0431 e 24,3. O que esses números realmente significam?
</div>
<p>Interpretar o parâmetro de inclinação é útil em quase qualquer aplicação. Para cada adicional de $1,000 de renda familiar, esperamos que um aluno receba uma diferença líquida de <span class="math inline">\(\$\text{1,000}\times (-0.0431) = -\$43.10\)</span> em ajuda, em média, ou seja, $43,10 <em>menos</em>. Note que uma renda familiar maior corresponde a menos ajuda, pois o coeficiente de renda familiar é negativo no modelo. Devemos ser cautelosos nessa interpretação: embora exista uma associação real, não podemos interpretar uma conexão causal entre as variáveis porque esses dados são observacionais. Ou seja, aumentar a renda familiar de um aluno pode não causar a queda da ajuda ao aluno. (Seria razoável entrar em contato com a faculdade e perguntar se a relação é causal, ou seja, se as decisões de ajuda da Elmhurst College são parcialmente baseadas na renda familiar dos alunos.)</p>
<p>O intercepto estimado em <span class="math inline">\(b_0=24,3\)</span> (em $1000s) descreve a ajuda média se a família de um aluno não tiver renda. O significado do intercepto é relevante para esta aplicação, uma vez que a renda familiar para alguns alunos do Elmhurst é de $0. Em outras aplicações, o intercepto pode ter pouco ou nenhum valor prático se não houver observações em que <span class="math inline">\(x\)</span> é próximo de zero.</p>
<div class="alert alert-info">
<p><strong>Interpretando parâmetros estimados por mínimos quadrados</strong>: A inclinação descreve a diferença estimada na variável <span class="math inline">\(y\)</span> se a variável explicativa <span class="math inline">\(x\)</span> para o aumento de uma unidade. O intercepto descreve o resultado médio de <span class="math inline">\(y\)</span> se <span class="math inline">\(x=0\)</span> e o modelo linear é válido até <span class="math inline">\(x = 0\)</span>, o que em muitas aplicações não é o caso.</p>
</div>
</div>
<div id="a-extrapolação-é-traiçoeira" class="section level3" number="1.2.5">
<h3><span class="header-section-number">1.2.5</span> A extrapolação é traiçoeira</h3>
<blockquote>
<p>Quando aquelas tempestades de neve atingiram a costa leste neste inverno, provou para minha satisfação que o aquecimento global era uma fraude. Aquela neve estava gelada. Mas em uma tendência alarmante, as temperaturas nesta primavera aumentaram. Considere isto: em 6 de fevereiro foi de 10 graus. Hoje atingiu quase 80. A este ritmo, até agosto será de 220 graus. Então, claramente pessoal, o debate sobre o clima continua. - Stephen Colbert, 6 de Abril de 2010.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
</blockquote>
<p>Modelos lineares podem ser usados para aproximar o relacionamento entre duas variáveis. No entanto, esses modelos têm limitações reais. A regressão linear é simplesmente uma estrutura de modelagem. A verdade é quase sempre muito mais complexa do que a nossa linha simples. Por exemplo, não sabemos como os dados fora da nossa janela limitada se comportarão.</p>

<div class="example">
<span id="exm:unnamed-chunk-13" class="example"><strong>Exemplo 1.7  </strong></span>Use o modelo <span class="math inline">\(\widehat{auxilio} = 24.3 - 0.0431\times renda\_\hspace{0.3mm}familiar\)</span> para estimar a ajuda de outro estudante calouro cuja família tinha renda de $1 milhões.
</div>
<p>Lembre-se que as unidades de renda familiar estão em $1000s, então queremos calcular o auxílio para <span class="math inline">\(renda\_\hspace{0.3mm}familiar = 1000\)</span>:</p>
<p><span class="math display">\[\begin{align*}
24,3 – 0,0431\times renda\_\hspace{0.3mm}familiar  = 24,3 – 0,0431\times 1000 = -18,8
\end{align*}\]</span></p>
<p>O modelo prevê que esse aluno irá ter -$18,800 em auxílio (!). O Elmhurst College não pode exigir que os estudantes paguem uma taxa adicional para pagar a matrícula.</p>
<p>A aplicação de uma estimativa de modelo a valores fora do domínio dos dados originais é denominada <strong>extrapolação</strong>. Geralmente, um modelo linear é apenas uma aproximação da relação real entre duas variáveis. Se extrapolarmos, estamos apostando que a relação linear aproximada será válida em lugares onde não foi analisada.</p>
</div>
<div id="usando-r2-para-descrever-a-força-de-um-ajuste" class="section level3" number="1.2.6">
<h3><span class="header-section-number">1.2.6</span> Usando <span class="math inline">\(R^2\)</span> para descrever a força de um ajuste</h3>
<p>Avaliamos a força da relação linear entre duas variáveis anteriormente usando a correlação, <span class="math inline">\(R\)</span>. No entanto, é mais comum explicar a força de um ajuste linear usando <span class="math inline">\(R^2\)</span>, chamado <strong>R-quadrado (<span class="math inline">\(R^2\)</span>)</strong>. Se fornecido com um modelo linear, gostaríamos de descrever o quão próximo o conjunto de dados está do ajuste linear.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="at">mapping =</span> <span class="fu">aes</span>(family_income, gift_aid)) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Renda Familiar ($1000s)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Auxílio-presente da </span><span class="sc">\n</span><span class="st">universidade ($1000s)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:elmhurstScatterWLSROnly"></span>
<img src="ch7_reg_simples_files/figure-html/elmhurstScatterWLSROnly-1.png" alt="Gift aid e renda familiar para uma amostra aleatória de 50 estudantes calouros do Elmhurst College, mostrada com a linha de regressão de mínimos quadrados." width="100%" height="30%" />
<p class="caption">
Figura 1.13: Gift aid e renda familiar para uma amostra aleatória de 50 estudantes calouros do Elmhurst College, mostrada com a linha de regressão de mínimos quadrados.
</p>
</div>
<p>O <span class="math inline">\(R^2\)</span> de um modelo linear descreve a quantidade de variação na resposta que é explicada pela linha de mínimos quadrados. Por exemplo, considere os dados de Elmhurst, mostrados na Figura <a href="#fig:elmhurstScatterWLSROnly">1.13</a>. A variância da variável resposta, a ajuda recebida, é <span class="math inline">\(s_{aid}^2=29,8\)</span>. No entanto, se aplicarmos nossa linha de mínimos quadrados, esse modelo reduz nossa incerteza na previsão de ajuda usando a renda familiar de um aluno. A variabilidade nos resíduos descreve quanta variação permanece após o uso do modelo: <span class="math inline">\(s_{_{RES}}^2 = 22.4\)</span>. Em suma, houve uma redução de</p>
<p><span class="math display">\[\frac{s_{aid}^2 - s_{_{RES}}^2}{s_{aid}^2}
    = \frac{29,8 – 22,4}{29,8} = \frac{7,5}{29,8}
    = 0,25\]</span></p>
<p>ou cerca de 25% na variação dos dados usando informações sobre a renda familiar para prever a ajuda usando um modelo linear. Isso corresponde exatamente ao valor de R-quadrado:</p>
<p><span class="math display">\[\begin{align*}
R &amp;= -0,499 &amp;R^2 &amp;= 0,25
\end{align*}\]</span></p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-14" class="exercise"><strong>Prática Orientada 1.8  </strong></span>Se um modelo linear tem uma relação negativa muito forte com uma correlação de -0,97, quanto da variação na resposta é explicada pela variável explicativa?<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>
</div>
<hr />
</div>
<div id="categoricalPredictorsWithTwoLevels" class="section level3" number="1.2.7">
<h3><span class="header-section-number">1.2.7</span> Preditores categóricos com dois níveis</h3>
<p>Variáveis categóricas também são úteis na previsão de resultados. Aqui nós consideramos um preditor categórico com dois níveis (lembre-se que um nível é o mesmo que uma categoria). Vamos considerar os leilões Ebay para um videogame, <em>Mario Kart</em> para o Nintendo Wii, onde foram registrados o preço total do leilão e as condições do jogo<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>. Aqui, queremos prever o preço total com base na condição do jogo, que recebe valores usado (0) e novo (1). Um gráfico dos dados do leilão é mostrado na Figura <a href="#fig:marioKartNewUsed">1.14</a>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(COL)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(marioKart)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>mk      <span class="ot">&lt;-</span> marioKart[marioKart<span class="sc">$</span>totalPr <span class="sc">&lt;</span> <span class="dv">100</span>, ]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>mk<span class="sc">$</span>cond <span class="ot">&lt;-</span> <span class="fu">relevel</span>(mk<span class="sc">$</span>cond, <span class="st">&quot;used&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>cond <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(mk<span class="sc">$</span>cond <span class="sc">==</span> <span class="st">&quot;new&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="fu">as.factor</span>(cond), mk<span class="sc">$</span>totalPr), <span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Preço Total&#39;</span>, <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.6</span>, <span class="at">y =</span> <span class="dv">35</span>, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(price) <span class="sc">*</span><span class="st">&quot; = 42.87 + 10.90 x cond_new&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:marioKartNewUsed"></span>
<img src="ch7_reg_simples_files/figure-html/marioKartNewUsed-1.png" alt="Preços totais de leilão para o videogame Mario Kart, divididos em jogos de condição usados (x = 0) e novos (x = 1). A linha de regressão dos mínimos quadrados também é mostrada." width="100%" height="30%" />
<p class="caption">
Figura 1.14: Preços totais de leilão para o videogame Mario Kart, divididos em jogos de condição usados (x = 0) e novos (x = 1). A linha de regressão dos mínimos quadrados também é mostrada.
</p>
</div>
<p>Para incorporar a variável de condição de jogo em uma equação de regressão, devemos converter as categorias em uma forma numérica. Faremos isso usando uma <strong>variável indicadora</strong> chamada <code>cond_nova</code>, que leva valor 1 quando o jogo é novo e 0 quando o jogo é usado. Usando esta variável indicadora, o modelo linear pode ser escrito como</p>
<p><span class="math display">\[\begin{align*}
\widehat{preço} = \beta_0 + \beta_1 \times cond\_\hspace{0.3mm}nova
\end{align*}\]</span></p>
<p>O modelo ajustado está resumido na Tabela <a href="#tab:marioKartNewUsedRegrSummary">1.3</a>, e o modelo com seus parâmetros estimados é dado como</p>
<p><span class="math display">\[\begin{align*}
\widehat{preço} = 42.87 + 10.90 \times cond\_\hspace{0.3mm}nova
\end{align*}\]</span></p>
<p>Para preditores categóricos com apenas dois níveis, a suposição de linearidade será sempre satisfeita. No entanto, devemos avaliar se os resíduos em cada grupo são aproximadamente normais e têm variância aproximadamente igual. Como pode ser visto na Figura <a href="#fig:marioKartNewUsed">1.14</a>, ambas as condições são razoavelmente satisfeitas pelos dados do leilão.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">lm</span>(mk<span class="sc">$</span>totalPr <span class="sc">~</span> cond)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">summary</span>(g)<span class="sc">$</span>coefficients)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(temp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Estimativa&#39;</span>, <span class="st">&#39;Erro Padrão&#39;</span>, <span class="st">&#39;valor t&#39;</span>, <span class="st">&#39;Pr(&gt;|t|)&#39;</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(temp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;(Interceptio)&#39;</span>, <span class="st">&#39;Condição do Jogo&#39;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp, <span class="at">align =</span> <span class="st">&#39;c&#39;</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&#39;Resumo de regressão por mínimos quadrados para o preço final do leilão em relação à condição do jogo.&#39;</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<caption><span id="tab:marioKartNewUsedRegrSummary">Tabela 1.3: </span>Resumo de regressão por mínimos quadrados para o preço final do leilão em relação à condição do jogo.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Estimativa</th>
<th align="center">Erro Padrão</th>
<th align="center">valor t</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Interceptio)</td>
<td align="center">42.87</td>
<td align="center">0.81</td>
<td align="center">52.67</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="left">Condição do Jogo</td>
<td align="center">10.90</td>
<td align="center">1.26</td>
<td align="center">8.66</td>
<td align="center">0</td>
</tr>
</tbody>
</table>

<div class="example">
<span id="exm:unnamed-chunk-15" class="example"><strong>Exemplo 1.8  </strong></span>Interprete os dois parâmetros estimados no modelo para o preço de <em>Mario Kart</em> nos leilões do eBay.
</div>
<p>O intercepto é o preço estimado quando a condição do jogo leva o valor 0, ou seja, quando o jogo está em condição usada. Ou seja, o preço médio de venda de uma versão usada do jogo é $42,87.</p>
<p>A inclinação indica que, em média, os novos jogos são vendidos por cerca de $10,90 a mais que os jogos usados.</p>
<div class="alert alert-info">
<p><strong>Interpretando estimativas do modelo para preditores categóricos.</strong>: A intersecção estimada é o valor da variável de resposta para a primeira categoria (ou seja, a categoria correspondente a um valor indicativo de 0). A inclinação estimada é a mudança média na variável de resposta entre as duas categorias.</p>
</div>
<p>Vamos elaborar mais sobre os dados do leilão do Ebay no próximo capítulo, onde examinamos a influência de muitas variáveis preditoras simultaneamente usando a regressão múltipla. Na regressão múltipla, consideraremos a associação do preço de leilão em relação a cada variável enquanto controlamos a influência de outras variáveis. Isso é especialmente importante, já que alguns dos preditores estão associados. Por exemplo, leilões com jogos novos também costumam vir com mais acessórios.</p>
</div>
</div>
<div id="typesOfOutliersInLinearRegression" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Tipos de outliers em regressão linear</h2>
<p>Nesta seção, identificamos critérios para determinar quais outliers são importantes e influentes. Outliers na regressão são observações que estão longe da “nuvem” de pontos. Esses pontos são especialmente importantes porque podem ter uma forte influência na linha de mínimos quadrados.</p>

<div class="example">
<span id="exm:outlierPlotsExample" class="example"><strong>Exemplo 1.9  </strong></span>Há seis gráficos mostrados na Figura <a href="#fig:outlierPlots">1.15</a> juntamente com a linha de mínimos quadrados e os resíduos. Para cada gráfico de dispersão e par de resíduos, identifique os outliers e observe como eles influenciam a linha de mínimos quadrados. Lembre-se de que um outlier é um ponto que não parece pertencer ao mesmo grupo da grande maioria dos outros pontos.
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pls <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x,g<span class="sc">$</span>residuals)) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">25</span>, <span class="dv">78</span>, <span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">150</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">7</span>, <span class="sc">-</span><span class="dv">19</span>, <span class="dv">0</span>, <span class="dv">40</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>xr <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fl">0.3</span>, <span class="dv">2</span>, <span class="fl">1.42</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>           <span class="fu">runif</span>(<span class="dv">4</span>, <span class="fl">1.45</span>, <span class="fl">1.55</span>),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>           <span class="fl">5.78</span>, <span class="sc">-</span><span class="fl">0.6</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>yr <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">8</span>, <span class="dv">19</span>,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="sc">-</span><span class="dv">17</span>, <span class="sc">-</span><span class="dv">20</span>, <span class="sc">-</span><span class="dv">21</span>, <span class="sc">-</span><span class="dv">19</span>),</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>           <span class="dv">12</span>, <span class="sc">-</span><span class="fl">23.2</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>graf <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>resf <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n[i])</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> m[i] <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n[i])</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(x, xr[[i]])</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">c</span>(y, yr[[i]])</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  graf[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(x,y)) <span class="sc">+</span> </span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;skyblue3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&#39;(&#39;</span>,i,<span class="st">&#39;)&#39;</span>)) <span class="sc">+</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  resf[[i]] <span class="ot">&lt;-</span> <span class="fu">pls</span>(x,y)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(graf[[<span class="dv">1</span>]], graf[[<span class="dv">2</span>]], graf[[<span class="dv">3</span>]], </span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>                        resf[[<span class="dv">1</span>]], resf[[<span class="dv">2</span>]], resf[[<span class="dv">3</span>]], </span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>                        graf[[<span class="dv">4</span>]], graf[[<span class="dv">5</span>]], graf[[<span class="dv">6</span>]],</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>                        resf[[<span class="dv">4</span>]], resf[[<span class="dv">5</span>]], resf[[<span class="dv">6</span>]], <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:outlierPlots"></span>
<img src="ch7_reg_simples_files/figure-html/outlierPlots-1.png" alt="Seis gráficos, cada uma com uma linha de mínimos quadrados e gráfico de resíduos. Todos os conjuntos de dados têm pelo menos um outlier." width="100%" height="30%" />
<p class="caption">
Figura 1.15: Seis gráficos, cada uma com uma linha de mínimos quadrados e gráfico de resíduos. Todos os conjuntos de dados têm pelo menos um outlier.
</p>
</div>
<ul>
<li><p><strong>(1)</strong> Existe um outlier longe dos outros pontos, embora pareça apenas influenciar levemente a reta.</p></li>
<li><p><strong>(2)</strong> Há um outlier à direita, embora esteja bem próximo da linha de mínimos quadrados, o que sugere que não foi muito influente.</p></li>
<li><p><strong>(3)</strong> Há um ponto longe da nuvem, e este outlier parece puxar a linha de mínimos quadrados para a direita; examine como a linha ao redor da nuvem primária não parece se encaixar muito bem.</p></li>
<li><p><strong>(4)</strong> Existe uma nuvem primária e uma pequena nuvem secundária de quatro outliers. A nuvem secundária parece estar influenciando fortemente a linha, fazendo com que a linha de mínimos quadrada se encaixe mal em quase todos os lugares. Pode haver uma explicação interessante para as nuvens duplas, que é algo que poderia ser investigado.</p></li>
<li><p><strong>(5)</strong> Não há uma tendência óbvia na nuvem principal de pontos e o outlier à direita parece controlar amplamente a inclinação da linha de mínimos quadrados.</p></li>
<li><p><strong>(6)</strong> Existe um outlier longe da nuvem, no entanto, cai bastante perto da linha de mínimos quadrados e não parece ser muito influente.</p></li>
</ul>
<p>Examine os gráficos de resíduos na Figura <a href="#fig:outlierPlots">1.15</a>. Você provavelmente descobrirá que há alguma tendência nas nuvens principais de (3) e (4). Nestes casos, os outliers influenciaram a inclinação das linhas de mínimos quadrados. Em (5), os dados sem tendência clara foram atribuídos a uma linha com uma tendência grande simplesmente devido a um outlier (!).</p>
<div class="alert alert-info">
<p><strong>Alavancas</strong>: Pontos que caem horizontalmente para longe do centro da nuvem tendem a puxar mais forte na linha, então nós os chamamos de pontos com <strong>alta alavancagem</strong>.</p>
</div>
<p>Pontos que caem horizontalmente longe da linha são pontos de alta alavancagem; esses pontos podem influenciar fortemente a inclinação da linha de mínimos quadrados. Se um desses pontos de alavancagem alta parece realmente influenciar na inclinação da linha – como nos casos (3), (4) e (5) do Exemplo <a href="#exm:outlierPlotsExample">1.9</a> – então chamamos de <strong>ponto influente</strong>. Normalmente, podemos dizer que um ponto é influente se, se tivéssemos ajustado a linha sem ele, o ponto influente teria sido extraordinariamente distante da linha de mínimos quadrados.</p>
<p>É tentador remover os outliers. Não faça isso sem um bom motivo. Modelos que ignoram casos excepcionais (e interessantes) geralmente apresentam desempenho insatisfatório. Por exemplo, se uma firma financeira ignorasse as maiores oscilações do mercado – os “outliers” – eles logo iriam à falência fazendo investimentos mal pensados.</p>
<div class="alert alert-info">
<p><strong>Não ignore outliers ao montar um modelo final</strong>: Se houver valores discrepantes nos dados, eles não devem ser removidos ou ignorados sem um bom motivo. Seja qual for o modelo final adequado aos dados, não seria muito útil ignorar os casos mais excepcionais.</p>
</div>
<div class="alert alert-info">
<p><strong>Outliers para um preditor categórico com dois níveis</strong>: Seja cauteloso ao usar um preditor categórico quando um dos níveis tiver poucas observações. Quando isso acontece, essas poucas observações se tornam pontos influentes.</p>
</div>
</div>
<div id="inferenceForLinearRegression" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Inferência para regressão linear</h2>
<p>Nesta seção, discutimos a incerteza nas estimativas da inclinação e do intercepto de y para uma linha de regressão. Assim como identificamos erros-padrão para estimativas pontuais nos capítulos anteriores, primeiro discutimos erros-padrão para essas novas estimativas. No entanto, no caso de regressão, identificaremos erros padrão usando <em>software</em> estatístico.</p>
<div id="eleições-de-meio-de-mandato-e-desemprego" class="section level3" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Eleições de meio de mandato e desemprego</h3>
<p>As eleições para os membros da Câmara dos Representantes dos Estados Unidos ocorrem a cada dois anos, coincidindo a cada quatro anos com a eleição presidencial dos EUA. O conjunto de eleições da Câmara que ocorre durante o meio de um mandato presidencial é chamado de <strong>midterm elections</strong>. No sistema bipartidário americano, uma teoria política sugere que quanto maior a taxa de desemprego, pior o partido do presidente fará nas eleições de meio de mandato.</p>
<p>Para avaliar a validade dessa afirmação, podemos compilar dados históricos e procurar uma conexão. Consideramos todas as eleições intercalares de 1898 a 2010, com exceção das eleições durante a Grande Depressão. A Figura <a href="#fig:unemploymentAndChangeInHouse">1.16</a> mostra estes dados e a linha de regressão de mínimos quadrados:</p>
<p><span class="math display">\[\begin{align*}
&amp;\text{% mudança em assentos da casa para o partido do presidente}  \\
&amp;\qquad\qquad= -6,71 – 1,00\times \text{(taxa de desemprego)}
\end{align*}\]</span></p>
<p>Consideramos a variação percentual no número de assentos do partido do Presidente (por exemplo, variação percentual no número de assentos para os democratas em 2010) em relação à taxa de desemprego.</p>
<p>Examinando os dados, não há desvios evidentes da linearidade, da condição de variância constante ou da normalidade dos resíduos (embora não examinemos aqui um gráfico de probabilidade normal). Enquanto os dados são coletados sequencialmente, uma análise separada foi usada para verificar qualquer correlação aparente entre observações sucessivas; nenhuma correlação foi encontrada.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(unempl)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(house)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(president)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> house</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>pres <span class="ot">&lt;-</span> president</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>year   <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1898</span>, <span class="dv">2010</span>, <span class="dv">4</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>n      <span class="ot">&lt;-</span> <span class="fu">length</span>(year)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>unemp  <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>change <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>presid <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, n)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>party  <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, n)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  urow <span class="ot">&lt;-</span> <span class="fu">which</span>(unempl<span class="sc">$</span>year <span class="sc">==</span> year[i]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&lt;</span> n) {</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    prow <span class="ot">&lt;-</span> <span class="fu">which</span>(pres<span class="sc">$</span>end <span class="sc">&gt;</span> year[i])[<span class="dv">1</span>]</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    prow <span class="ot">&lt;-</span> <span class="fu">which</span>(pres<span class="sc">$</span>potus <span class="sc">==</span> <span class="st">&quot;Barack Obama&quot;</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  hrow <span class="ot">&lt;-</span> <span class="fu">which</span>(h<span class="sc">$</span>yearEnd <span class="sc">&gt;=</span> year[i])[<span class="dv">1</span>]</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  party[i] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(pres<span class="sc">$</span>party[prow])</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">substr</span>(h<span class="sc">$</span>p1[hrow], <span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">==</span> <span class="fu">substr</span>(party[i], <span class="dv">1</span>, <span class="dv">5</span>)) {</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    oldHouse <span class="ot">&lt;-</span> h<span class="sc">$</span>np1[hrow] <span class="sc">/</span> h<span class="sc">$</span>seats[hrow]</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    oldHouse <span class="ot">&lt;-</span> h<span class="sc">$</span>np2[hrow] <span class="sc">/</span> h<span class="sc">$</span>seats[hrow]</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">substr</span>(h<span class="sc">$</span>p1[hrow <span class="sc">+</span> <span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">==</span> <span class="fu">substr</span>(party[i], <span class="dv">1</span>, <span class="dv">5</span>)) {</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    newHouse <span class="ot">&lt;-</span> h<span class="sc">$</span>np1[hrow <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">/</span> h<span class="sc">$</span>seats[hrow <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    newHouse <span class="ot">&lt;-</span> h<span class="sc">$</span>np2[hrow <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">/</span> h<span class="sc">$</span>seats[hrow <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  change[i] <span class="ot">&lt;-</span> (newHouse <span class="sc">-</span> oldHouse) <span class="sc">/</span> oldHouse <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  presid[i] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(pres<span class="sc">$</span>potus[prow])</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  unemp[i]  <span class="ot">&lt;-</span> unempl<span class="sc">$</span>unemp[urow]</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>unemployPres <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> year,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>                           <span class="at">potus =</span> presid,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>                           <span class="at">party =</span> party,</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>                           <span class="at">unemp =</span> unemp,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>                           <span class="at">change =</span> change)</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> <span class="sc">!</span>year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1935</span>, <span class="dv">1939</span>)</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>repub <span class="ot">&lt;-</span> (unemployPres<span class="sc">$</span>party[th] <span class="sc">==</span> <span class="st">&quot;Republican&quot;</span>)</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(unemployPres<span class="sc">$</span>unemp[th], unemployPres<span class="sc">$</span>change[th])) <span class="sc">+</span> </span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(repub <span class="sc">==</span> <span class="st">&#39;TRUE&#39;</span>, <span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;skyblue3&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Percentual de desemprego&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Variação percentual de </span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a><span class="st">       assentos do partido do presidente </span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a><span class="st">       na Câmara dos Deputados&#39;</span>) <span class="sc">+</span> </span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unemploymentAndChangeInHouse"></span>
<img src="ch7_reg_simples_files/figure-html/unemploymentAndChangeInHouse-1.png" alt="A porcentagem de mudança nas cadeiras da Câmara para o partido do presidente em cada eleição de 1898 a 2010 foi traçada contra a taxa de desemprego. Os dois pontos para a Grande Depressão foram removidos e uma linha de regressão de mínimos quadrados foi ajustada aos dados." width="100%" height="30%" />
<p class="caption">
Figura 1.16: A porcentagem de mudança nas cadeiras da Câmara para o partido do presidente em cada eleição de 1898 a 2010 foi traçada contra a taxa de desemprego. Os dois pontos para a Grande Depressão foram removidos e uma linha de regressão de mínimos quadrados foi ajustada aos dados.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-16" class="exercise"><strong>Prática Orientada 1.9  </strong></span>Os dados para a Grande Depressão (1934 e 1938) foram removidos porque a taxa de desemprego era de 21% e 18%, respectivamente. Você concorda que eles devem ser removidos para esta investigação? Por que ou por que não?<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a>
</div>
<hr />
<p>Há uma inclinação negativa na linha mostrada na Figura <a href="#fig:unemploymentAndChangeInHouse">1.16</a>. No entanto, esta inclinação (e intercepto) são apenas estimativas dos valores dos parâmetros. Poderíamos nos perguntar: essa evidência convincente de que o modelo linear “verdadeiro” tem uma inclinação negativa? Ou seja, os dados fornecem fortes evidências de que a teoria política é exata? Podemos enquadrar essa investigação em um teste de hipótese estatística unilateral:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\beta_1 = 0\)</span>. O verdadeiro modelo linear tem inclinação zero.</p></li>
<li><p><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\beta_1 &lt; 0\)</span>. O modelo linear verdadeiro tem uma inclinação menor que zero. Quanto maior o desemprego, maior a perda para o partido do presidente na Câmara dos Representantes.</p></li>
</ul>
<p>Nós rejeitaríamos <span class="math inline">\(H_0\)</span> em favor de <span class="math inline">\(H_1\)</span> se os dados fornecerem fortes evidências de que o parâmetro de inclinação real é menor que zero. Para avaliar as hipóteses, identificamos um erro padrão para a estimativa, calculamos uma estatística de teste apropriada e identificamos o p-valor.</p>
</div>
<div id="testStatisticForTheSlope" class="section level3" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Entendendo a saída de regressão do software</h3>
<p>Assim como outras estimativas pontuais que vimos antes, podemos calcular um erro padrão e testar a estatística para <span class="math inline">\(b_1\)</span>. Em geral, rotularemos a estatística de teste usando um <span class="math inline">\(T\)</span>, já que ela segue a distribuição <span class="math inline">\(t\)</span>.</p>
<p>Contaremos com <em>software</em> estatístico para calcular o erro padrão e deixar a explicação de como esse erro padrão é determinado para um segundo ou terceiro curso de estatística. A Tabela <a href="#tab:midtermElectionUnemploymentRRegressionOutput">1.4</a> mostra a saída de software para a linha de regressão de mínimos quadrados na Figura <a href="#fig:unemploymentAndChangeInHouse">1.16</a>. A linha chamada <strong>desempregado</strong> representa a informação para a inclinação, que é o coeficiente da variável desemprego.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(change <span class="sc">~</span> unemp, unemployPres))<span class="sc">$</span>coefficients</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(temp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Estimativa&#39;</span>, <span class="st">&#39;Erro Padrão&#39;</span>, <span class="st">&#39;valor t&#39;</span>, <span class="st">&#39;Pr(&gt;|t|)&#39;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(temp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;(Intercepto)&#39;</span>, <span class="st">&#39;Desemprego&#39;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp, <span class="at">align =</span> <span class="st">&#39;r&#39;</span>, <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&#39;Saída do software estatístico para a linha de regressão que modela as perdas eleitorais a médio prazo para o partido do Presidente como resposta ao desemprego.&#39;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:midtermElectionUnemploymentRRegressionOutput">Tabela 1.4: </span>Saída do software estatístico para a linha de regressão que modela as perdas eleitorais a médio prazo para o partido do Presidente como resposta ao desemprego.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimativa</th>
<th align="right">Erro Padrão</th>
<th align="right">valor t</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercepto)</td>
<td align="right">-12.68</td>
<td align="right">3.56</td>
<td align="right">-3.56</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Desemprego</td>
<td align="right">0.04</td>
<td align="right">0.45</td>
<td align="right">0.08</td>
<td align="right">0.93</td>
</tr>
</tbody>
</table>

<div class="example">
<span id="exm:unnamed-chunk-17" class="example"><strong>Exemplo 1.10  </strong></span>O que as primeiras e segundas colunas da Tabela <a href="#tab:midtermElectionUnemploymentRRegressionOutput">1.4</a> representam?
</div>
<p>As entradas na primeira coluna representam as estimativas de mínimos quadrados, <span class="math inline">\(b_0\)</span> e <span class="math inline">\(b_1\)</span>, e os valores na segunda coluna correspondem aos erros padrão de cada estimativa.</p>
<p>Anteriormente, usamos uma estatística de teste-<span class="math inline">\(t\)</span> para testes de hipóteses no contexto de dados numéricos. Regressão é muito semelhante. Nas hipóteses que consideramos, o valor nulo para a inclinação é 0, então podemos calcular a estatística de teste usando a fórmula do teste T (ou Z):</p>
<p><span class="math display">\[\begin{align*}
T = \frac{\text{estimativa} - \text{valor nulo}}{\text{EP}} = \frac{-1.0010 - 0}{0.8717} = -1.15
\end{align*}\]</span></p>
<p>Podemos procurar o p-valor unilateral – mostrado na Figura <a href="#fig:oneSidedTailForMidtermUnemploymentHT">1.17</a> – usando a tabela de probabilidades para a distribuição-<span class="math inline">\(t\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fl">0.8717</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> m <span class="sc">+</span> s <span class="sc">*</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(X, m, s)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>gg   <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,Y)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gg, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="at">data =</span> gg[gg<span class="sc">$</span>X <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">1.0010</span>,], <span class="fu">aes</span>(X, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">&quot;skyblue3&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">seq</span>(m <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>s, m <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>s, s),<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:oneSidedTailForMidtermUnemploymentHT"></span>
<img src="ch7_reg_simples_files/figure-html/oneSidedTailForMidtermUnemploymentHT-1.png" alt="A distribuição mostrada aqui é a distribuição amostral para b1, se a hipótese nula for verdadeira. A cauda sombreada representa o p-valor para o teste de hipótese que avalia se há evidência convincente de que o desemprego mais elevado corresponde a uma maior perda de assentos na Câmara para o partido do Presidente durante uma eleição de meio de mandato." width="100%" height="30%" />
<p class="caption">
Figura 1.17: A distribuição mostrada aqui é a distribuição amostral para b1, se a hipótese nula for verdadeira. A cauda sombreada representa o p-valor para o teste de hipótese que avalia se há evidência convincente de que o desemprego mais elevado corresponde a uma maior perda de assentos na Câmara para o partido do Presidente durante uma eleição de meio de mandato.
</p>
</div>

<div class="example">
<span id="exm:unnamed-chunk-18" class="example"><strong>Exemplo 1.11  </strong></span>A Tabela <a href="#tab:midtermElectionUnemploymentRRegressionOutput">1.4</a> oferece os graus de liberdade para a estatística de teste-<span class="math inline">\(T\)</span>: <span class="math inline">\(df = 25\)</span>. Identifique o p-valor para o teste de hipótese.
</div>
<p>Olhando na linha de 25 graus de liberdade, Vemos que o valor absoluto da estatística de teste é menor do que qualquer valor listado, o que significa que a área da cauda e, portanto, também o p-valor é maior que 0,100 (uma cauda!). Como o p-valor é tão grande, deixamos de rejeitar a hipótese nula. Ou seja, os dados não fornecem evidências convincentes de que uma taxa de desemprego mais alta tenha qualquer relação com perdas menores ou maiores para o partido do Presidente na Câmara dos Deputados nas eleições de meio de mandato.</p>
<p>Poderíamos ter identificado o teste-<span class="math inline">\(t\)</span> estatístico por software na Tabela <a href="#tab:midtermElectionUnemploymentRRegressionOutput">1.4</a>, mostrado na segunda linha (desempregado) e terceira coluna (valor t). A entrada na segunda linha e última coluna na Tabela <a href="#tab:midtermElectionUnemploymentRRegressionOutput">1.4</a> representa o p-valor para o teste de hipóteses bilateral, em que o valor nulo é zero. O teste unilateral correspondente a metade do p-valor listado.</p>
<div class="alert alert-info">
<p><strong>Inferência para regressão</strong>: Geralmente, utilizamos software estatístico para identificar estimativas pontuais e erros padrão para parâmetros de uma linha de regressão. Depois de verificar as condições para ajustar uma reta, podemos usar os métodos aprendidos anteriormente para a distribuição-<span class="math inline">\(t\)</span> para criar intervalos de confiança para parâmetros de regressão ou para avaliar testes de hipóteses.</p>
</div>
<div class="alert alert-info">
<p><strong>Não use descuidadamente o p-valor da saída de regressão</strong>: A última coluna na saída de regressão geralmente lista p-valores para uma hipótese particular: um teste bilateral onde o valor nulo é zero. Se o seu teste for unilateral e a estimativa pontual estiver na direção de <span class="math inline">\(H_1\)</span>, você poderá reduzir pela metade o p-valor do software para obter a área unilateral. Se nenhum desses cenários corresponder ao seu teste de hipótese, tenha cuidado ao usar a saída de software para obter o p-valor.</p>
</div>

<div class="example">
<span id="exm:overallAidIncomeInformalAssessmentOfRegressionLineSlope" class="example"><strong>Exemplo 1.12  </strong></span>Examine a Figura <a href="#fig:elmhurstScatterWLSROnly">1.13</a>, que relaciona a ajuda do Elmhurst College e a renda familiar dos estudantes. Como você está certo de que a inclinação é estatisticamente diferente de zero? Ou seja, você acha que um teste de hipótese formal rejeitaria a afirmação de que a inclinação real da linha deveria ser zero?
</div>
<p>Enquanto a relação entre as variáveis não é perfeita, há uma evidente tendência decrescente nos dados. Isso sugere que o teste de hipótese rejeitará a declaração nula de que a inclinação é zero.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-19" class="exercise"><strong>Prática Orientada 1.10  </strong></span>A Tabela <a href="#tab:rOutputForIncomeAidLSRLineInInferenceSection">1.5</a> mostra a saída de um software estatístico para o ajuste da linha de regressão de mínimos quadrados mostrada na Figura <a href="#fig:elmhurstScatterWLSROnly">1.13</a>. Use essa saída para avaliar formalmente as hipóteses a seguir.</p>
<p><span class="math inline">\(H_0\)</span>: O verdadeiro coeficiente de renda familiar é zero.</p>
<span class="math inline">\(H_1\)</span>: O coeficiente verdadeiro para a renda familiar não é zero.<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>
</div>
<hr />
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">lm</span>(gift_aid <span class="sc">~</span> family_income, d)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>tempor <span class="ot">&lt;-</span> <span class="fu">summary</span>(g)<span class="sc">$</span>coefficients</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tempor) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Estimativa&#39;</span>, <span class="st">&#39;Erro Padrão&#39;</span>, <span class="st">&#39;Valor t&#39;</span>, <span class="st">&#39;Pr(&gt;|t|)&#39;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tempor) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;(Intercepto)&#39;</span>, <span class="st">&#39;Renda Familiar&#39;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tempor, <span class="at">align =</span> <span class="st">&#39;r&#39;</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&#39;Resumo dos mínimos quadrados adequados aos dados do Elmhurst College.&#39;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:rOutputForIncomeAidLSRLineInInferenceSection">Tabela 1.5: </span>Resumo dos mínimos quadrados adequados aos dados do Elmhurst College.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimativa</th>
<th align="right">Erro Padrão</th>
<th align="right">Valor t</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercepto)</td>
<td align="right">24.32</td>
<td align="right">1.29</td>
<td align="right">18.83</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Renda Familiar</td>
<td align="right">-0.04</td>
<td align="right">0.01</td>
<td align="right">-3.98</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="alert alert-info">
<p><strong>Sempre cheque suposições</strong>: Se as condições para ajustar a linha de regressão não forem válidas, os métodos apresentados aqui não deverão ser aplicados. O pressuposto padrão de erro ou distribuição da estimativa pontual – considerado normal ao aplicar o teste-<span class="math inline">\(t\)</span> estatístico – pode não ser válido.</p>
</div>
<hr />
<center>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
</center>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Se um modelo subestimar uma observação, então a estimativa do modelo está abaixo da real. O resíduo, que é o valor de observação real menos a estimativa do modelo, deve então ser positivo. O oposto é verdadeiro quando o modelo superestima a observação: o resíduo é negativo.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>(<span class="math inline">\(+\)</span>) Primeiro calcule o valor previsto com base no modelo: <span class="math display">\[\hat{y}_{+} = 41+0,59x_{+} = 41+0,59\times 85,0 = 91,15\]</span> Então o resíduo é dado por <span class="math display">\[e_{+} = y_{+} - \hat{y}_{+} = 98,6-91,15=7,45.\]</span> Isso foi perto da estimativa anterior de 7. (<span class="math inline">\(\triangle\)</span>) <span class="math inline">\(\hat{y}_{\triangle} = 41+0,59x_{\triangle} = 97,3\)</span>. <span class="math inline">\(e_{\triangle} = y_{\triangle} - \hat{y}_{\triangle} = -3,3\)</span>, perto da estimativa de -4.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Formalmente, podemos calcular a correlação para observações <span class="math inline">\((x_1, y_1)\)</span>, <span class="math inline">\((x_2, y_2)\)</span>, …, <span class="math inline">\((x_n, y_n)\)</span> usando a fórmula R = <span class="math inline">\(\frac{1}{n-1}\sum_{i=1}^{n} \frac{x_i-\bar{x}}{s_x}\frac{y_i-\bar{y}}{s_y}\)</span>, onde <span class="math inline">\(\bar{x}\)</span>, <span class="math inline">\(\bar{y}\)</span>, <span class="math inline">\(s_x\)</span>, e <span class="math inline">\(s_y\)</span> são as médias amostrais e os desvios padrão para cada variável.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Deixaremos para você desenhar as linhas. Em geral, as linhas desenhadas devem estar próximas da maioria dos pontos e refletir as tendências gerais nos dados.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Estes dados foram coletados de uma tabela de dados para todos os calouros da turma de 2011 do Elmhurst College. Acompanhou um artigo intitulado <strong>O que os estudantes realmente pagam para ir para a faculdade</strong> publicado online pela A Crônica da Educação Superior<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Rendimentos familiares maiores estão associados a quantidades menores de ajuda, então a correlação será negativa. Usando um computador, a correlação pode ser calculada: -0.499.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>Existem aplicações onde o Critério <a href="#eq:sumOfAbsoluteValueOfResiduals">(1.3)</a> pode ser mais útil, e há muitos outros critérios que podemos considerar. No entanto, este livro aplica apenas o critério de mínimos quadrados.<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>A tendência parece ser linear, os dados caem ao redor da linha sem valores atípicos óbvios, a variação é aproximadamente constante. Estas também não são observações de séries temporais. Regressão de mínimos quadrados pode ser aplicada a esses dados.<a href="#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>Se você precisar de ajuda para encontrar este local, desenhe uma linha reta a partir do valor x de 100 (ou próximo disso). Em seguida, desenhe uma linha horizontal em 20 (ou próximo). Essas linhas devem se cruzar na linha de mínimos quadrados.<a href="#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>Aplicando a Equação <a href="#eq:slopeOfLSRLine">(1.5)</a> com as estatísticas resumidas da Tabela <a href="#tab:summaryStatsOfSATGPAData">1.1</a> calcular a inclinação: <span class="math inline">\(b_1 = \frac{s_y}{s_x} R = \frac{5.46}{63.2}(-0.499) = -0.0431\)</span><a href="#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>www.cc.com/video-clips/l4nkoq<a href="#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p><span class="math inline">\(R^2 = (-0.97)^2 = 0.94\)</span> ou 94% da variação é explicada pelo modelo linear.<a href="#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>Estes dados foram coletados no outono de 2009 e pode ser encontrado em openintro.org.<a href="#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>Forneceremos duas considerações. Cada um desses pontos teria uma alavancagem muito alta em qualquer linha de regressão de mínimos quadrados, e anos com tão alto desemprego podem não nos ajudar a entender o que aconteceria em outros anos em que o desemprego é apenas modestamente alto. Por outro lado, são casos excepcionais, e estaríamos descartando informações importantes se as excluirmos de uma análise final.<a href="#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>Examinamos a segunda linha correspondente à variável renda familiar. Vemos que a estimativa pontual da inclinação da linha é de -0,0431, o erro padrão dessa estimativa é de 0,0108 e a estatística do teste-<span class="math inline">\(t\)</span> é de -3,98. O p-valor corresponde exatamente ao teste bilateral em que estamos interessados: 0.0002. O p-valor é tão pequeno que rejeitamos a hipótese nula e concluímos que a renda familiar e a ajuda financeira do Elmhurst College para ingressantes no ano de 2011 estão negativamente correlacionadas e o verdadeiro parâmetro do coeficiente angular é de fato menor que 0, assim como acreditamos Exemplo <a href="#exm:overallAidIncomeInformalAssessmentOfRegressionLineSlope">1.12</a>.<a href="#fnref15" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 1
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ch7_reg_simples.pdf", "ch7_reg_simples.epub"],
"toc": {
"collapse": "subsubsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
